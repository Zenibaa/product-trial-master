<div class="cart-content" *ngIf="cartItems().length > 0; else emptyCart">
  <div class="cart-item" *ngFor="let item of cartItems(); trackBy: trackByItemId">

    <div class="flex justify-content-between align-items-start mb-3">
      <div class="cart-item-info flex-1">
        <h4 class="m-0 mb-1">{{ item.product?.name || 'Produit inconnu' }}</h4>
        <p class="text-primary font-bold m-0">{{ item.product?.price || 0 | currency:'EUR':'symbol':'1.2-2' }}</p>
      </div>

      <p-button
        icon="pi pi-trash"
        severity="danger"
        [text]="true"
        size="small"
        pTooltip="Supprimer du panier"
        (onClick)="removeFromCart(item.id)">
      </p-button>
    </div>

    <div class="flex justify-content-between align-items-center">

      <div class="flex align-items-center gap-2">
        <span class="text-sm text-500 mr-2">Quantité:</span>

        <p-button
          icon="pi pi-minus"
          size="small"
          [text]="true"
          severity="secondary"
          [disabled]="item.quantity <= 1"
          pTooltip="Diminuer la quantité"
          (onClick)="updateQuantity(item.id, item.quantity - 1)">
        </p-button>

        <span class="quantity-display px-3 py-1 border-1 border-300 border-round text-center font-semibold">
          {{ item.quantity }}
        </span>

        <p-button
          icon="pi pi-plus"
          size="small"
          [text]="true"
          severity="secondary"
          pTooltip="Augmenter la quantité"
          (onClick)="updateQuantity(item.id, item.quantity + 1)">
        </p-button>
      </div>

      <div class="text-right">
        <div class="text-sm text-500">Sous-total</div>
        <span class="font-bold text-primary text-lg">
          {{ ((item.product?.price || 0) * item.product.quantity) | currency:'EUR':'symbol':'1.2-2' }}
        </span>
      </div>
    </div>

  </div>
</div>

<!-- Panier vide -->
<ng-template #emptyCart>
  <div class="text-center py-8">
    <i class="pi pi-shopping-cart text-6xl text-300 mb-3"></i>
    <p class="text-500 text-lg">Votre panier est vide</p>
    <p class="text-400 text-sm">Ajoutez des articles pour commencer vos achats</p>
  </div>
</ng-template>

<!-- Footer du panier -->
<div class="cart-footer mt-4" *ngIf="cartItems().length > 0">
  <div class="border-top-1 border-300 pt-3">

    <!-- Résumé détaillé -->
    <div class="mb-3">
      <div class="flex justify-content-between align-items-center mb-2">
        <span class="text-500">Articles ({{ cartItemsCount() }})</span>
        <span class="text-500">{{ cartTotal() | currency:'EUR':'symbol':'1.2-2' }}</span>
      </div>

      <div class="flex justify-content-between align-items-center mb-2">
        <span class="text-500">Livraison</span>
        <span class="text-500">Gratuite</span>
      </div>

      <hr class="my-2">

      <div class="flex justify-content-between align-items-center">
        <span class="font-bold text-xl">Total:</span>
        <span class="font-bold text-xl text-primary">{{ cartTotal() | currency:'EUR':'symbol':'1.2-2' }}</span>
      </div>
    </div>

    <!-- Actions -->
    <p-button
      label="Passer commande ({{ cartItemsCount() }} article{{ cartItemsCount() > 1 ? 's' : '' }})"
      icon="pi pi-credit-card"
      severity="success"
      [style]="{ width: '100%' }"
      class="mb-2"
      (onClick)="checkout()">
    </p-button>

    <p-button
      label="Vider le panier"
      icon="pi pi-trash"
      severity="secondary"
      [style]="{ width: '100%' }"
      [text]="true"
      (onClick)="clearCart()">
    </p-button>
  </div>
</div>
